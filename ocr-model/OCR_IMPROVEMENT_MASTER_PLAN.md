# ğŸš€ OCR ì •í™•ë„ í–¥ìƒ ì¢…í•© ë§ˆìŠ¤í„° í”Œëœ

## ğŸ“Œ ëª©ì°¨
1. [í”„ë¡œì íŠ¸ ê°œìš”](#í”„ë¡œì íŠ¸-ê°œìš”)
2. [í˜„í™© ë¶„ì„](#í˜„í™©-ë¶„ì„)
3. [ê°œì„  ì „ëµ](#ê°œì„ -ì „ëµ)
4. [êµ¬í˜„ ê³„íš](#êµ¬í˜„-ê³„íš)
5. [í”„ë¡œì íŠ¸ êµ¬ì¡°](#í”„ë¡œì íŠ¸-êµ¬ì¡°)
6. [ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¶•](#ë°ì´í„°ë² ì´ìŠ¤-êµ¬ì¶•)
7. [ê¸°ìˆ ì  ê°œì„  ë°©ë²•](#ê¸°ìˆ ì -ê°œì„ -ë°©ë²•)
8. [ì„±ëŠ¥ ëª©í‘œ](#ì„±ëŠ¥-ëª©í‘œ)

---

## ğŸ“‹ í”„ë¡œì íŠ¸ ê°œìš”

### ëª©í‘œ
ì¶©ë¶ëŒ€í•™êµ ì„±ì ì¡°íšŒ ì‹œìŠ¤í…œì˜ ìŠ¤í¬ë¦°ìƒ·ì„ ì •í™•í•˜ê²Œ ì¸ì‹í•˜ê³  êµ¬ì¡°í™”ëœ ë°ì´í„°ë¡œ ë³€í™˜í•˜ëŠ” ê³ ì„±ëŠ¥ OCR ì‹œìŠ¤í…œ êµ¬ì¶•

### í•µì‹¬ ê°œì„  ë°©í–¥
1. **ì •í™•ë„ í–¥ìƒ**: ê³¼ëª© ë°ì´í„°ë² ì´ìŠ¤ í™œìš©ìœ¼ë¡œ 85% â†’ 95%+ ë‹¬ì„±
2. **ì²˜ë¦¬ ì†ë„ ê°œì„ **: í…Œì´ë¸” ì˜ì—­ë§Œ ì¶”ì¶œí•˜ì—¬ 2-3ë°° ì†ë„ í–¥ìƒ
3. **ë°ì´í„° êµ¬ì¡°í™”**: JSON/CSV í˜•ì‹ìœ¼ë¡œ ì¦‰ì‹œ í™œìš© ê°€ëŠ¥í•œ ì¶œë ¥

---

## ğŸ” í˜„í™© ë¶„ì„

### í˜„ì¬ ë¬¸ì œì 
- **í•œê¸€ ìëª¨ ì¸ì‹ ì˜¤ë¥˜**: `íƒˆì˜ì‹¤` â†’ `êµ°í‹°lì´`, `ì¸ìƒì„` â†’ `|Yê·¹ê°€oë¦‰`
- **ê³¼ëª©ëª… ì˜¤ì¸ì‹**: `ì»´í“¨í„°êµ¬ì¡°` â†’ `ì»´í“¨í„°êµ¬ì´ˆ`
- **íŠ¹ìˆ˜ë¬¸ì ì˜¤ì¸ì‹**: í•œê¸€ ëª¨ìŒ `ã…£`ë¥¼ `|`ë‚˜ `l`ë¡œ ì¸ì‹
- **ë‚®ì€ ì‹ ë¢°ë„**: ì¼ë¶€ í…ìŠ¤íŠ¸ì˜ confidence scoreê°€ 0.5-0.7 ìˆ˜ì¤€
- **í…Œì´ë¸” êµ¬ì¡° ì†ì‹¤**: í–‰/ì—´ êµ¬ë¶„ ë° ì •ë ¬ ë¬¸ì œ

### ê¸°ì¡´ ì •í™•ë„
- ê³¼ëª©ëª… ì •í™•ë„: 60%
- ê³¼ëª©ì½”ë“œ ì¸ì‹: 70%
- ì „ì²´ í…Œì´ë¸” ì •í™•ë„: 75%

---

## ğŸ¯ ê°œì„  ì „ëµ

### 1. ë°ì´í„°ë² ì´ìŠ¤ ê¸°ë°˜ ì •í™•ë„ í–¥ìƒ
- Excel ê³¼ëª© ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¶•
- í¼ì§€ ë§¤ì¹­ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ OCR ê²°ê³¼ ë³´ì •
- ì ì§„ì  í•™ìŠµ ì‹œìŠ¤í…œ êµ¬ì¶•

### 2. ì§€ëŠ¥í˜• ì˜ì—­ ê²€ì¶œ
- í…Œì´ë¸” ì˜ì—­ ìë™ ê²€ì¶œ
- ë¶ˆí•„ìš”í•œ UI ìš”ì†Œ í•„í„°ë§
- ROI(Region of Interest) ê¸°ë°˜ ì²˜ë¦¬

### 3. êµ¬ì¡°í™”ëœ ì¶œë ¥
- í…Œì´ë¸” êµ¬ì¡° ë³µì›
- JSON/CSV ìë™ ë³€í™˜
- ë©”íƒ€ë°ì´í„° í¬í•¨ (ì‹ ë¢°ë„, ì²˜ë¦¬ì‹œê°„)

---

## ğŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡°

### ê¶Œì¥ ë””ë ‰í† ë¦¬ êµ¬ì¡°
```
ocr-model/
â”œâ”€â”€ main.py                           # í˜„ì¬ ë©”ì¸ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ improved_main.py                  # ê°œì„ ëœ í†µí•© ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ requirements.txt                  # ì˜ì¡´ì„± íŒ¨í‚¤ì§€
â”œâ”€â”€ .gitignore                       # Git ì œì™¸ íŒŒì¼
â”œâ”€â”€
â”œâ”€â”€ # í•µì‹¬ OCR ëª¨ë“ˆ
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ ocr_engine.py                # PaddleOCR ë˜í¼
â”‚   â”œâ”€â”€ preprocessor.py              # ì´ë¯¸ì§€ ì „ì²˜ë¦¬
â”‚   â”œâ”€â”€ postprocessor.py             # í…ìŠ¤íŠ¸ í›„ì²˜ë¦¬
â”‚   â”œâ”€â”€ subject_matcher.py           # ê³¼ëª© DB ë§¤ì¹­
â”‚   â”œâ”€â”€ table_extractor.py           # í…Œì´ë¸” êµ¬ì¡° ì¶”ì¶œ
â”‚   â””â”€â”€ output_formatter.py          # JSON/CSV ë³€í™˜
â”œâ”€â”€
â”œâ”€â”€ # ë°ì´í„° ë° ì„¤ì •
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ subject_database.xlsx        # ê³¼ëª© ë°ì´í„°ë² ì´ìŠ¤
â”‚   â”œâ”€â”€ semester_courses/             # í•™ê¸°ë³„ ê°œì„¤ê°•ì¢Œ
â”‚   â”œâ”€â”€ training_data/                # í•™ìŠµ ë°ì´í„°
â”‚   â””â”€â”€ templates/                    # Excel í…œí”Œë¦¿
â”œâ”€â”€
â”œâ”€â”€ # API ì„œë²„
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ ocr_server.py                # FastAPI ì„œë²„
â”‚   â”œâ”€â”€ models.py                    # ë°ì´í„° ëª¨ë¸
â”‚   â””â”€â”€ endpoints.py                 # API ì—”ë“œí¬ì¸íŠ¸
â”œâ”€â”€
â”œâ”€â”€ # ìœ í‹¸ë¦¬í‹°
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ image_util.py                # ì´ë¯¸ì§€ ì²˜ë¦¬
â”‚   â”œâ”€â”€ file_handler.py              # íŒŒì¼ ì…ì¶œë ¥
â”‚   â””â”€â”€ validators.py                # ë°ì´í„° ê²€ì¦
â”œâ”€â”€
â”œâ”€â”€ # í…ŒìŠ¤íŠ¸
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ test_ocr_engine.py
â”‚   â”œâ”€â”€ test_preprocessor.py
â”‚   â””â”€â”€ fixtures/                    # í…ŒìŠ¤íŠ¸ ë°ì´í„°
â””â”€â”€
â””â”€â”€ # ë¡œê·¸ ë° ìºì‹œ
    â”œâ”€â”€ logs/
    â””â”€â”€ cache/
```

---

## ğŸ’¾ ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¶•

### 1. ì‹¤ì œ ê°œì„¤ê°•ì¢Œ ë°ì´í„° í™œìš© (2025-01í•™ê¸° ì†Œí”„íŠ¸ì›¨ì–´í•™ë¶€)
í˜„ì¬ ë³´ìœ í•œ **"ê°œì„¤ê°•ì¢Œ ëª©ë¡-2025-01í•™ê¸°-ì†Œí”„íŠ¸ì›¨ì–´í•™ë¶€.xlsx"** íŒŒì¼ì„ ê¸°ë°˜ìœ¼ë¡œ ê³¼ëª© ë°ì´í„°ë² ì´ìŠ¤ë¥¼ êµ¬ì¶•í•©ë‹ˆë‹¤.

#### ì˜ˆìƒ ë°ì´í„° êµ¬ì¡°
```excel
ê³¼ëª©ì½”ë“œ    | ê³¼ëª©ëª…           | ì˜ë¬¸ëª…                  | í•™ê³¼        | í•™ë…„ | í•™ì  | êµìˆ˜ëª… | ì‹œê°„í‘œ | ë³„ëª…/ì•½ì¹­
5118020    | ì»´í“¨í„°êµ¬ì¡°       | Computer Architecture  | ì»´í“¨í„°ê³µí•™   | 2    | 3    | ê¹€êµìˆ˜ | ì›”3,4  | ì»´êµ¬,ì»´í“¨í„°êµ¬ì¡°í•™
5120001    | ì˜¤í”ˆì†ŒìŠ¤í”Œë«í¼   | Open Source Platform   | ì»´í“¨í„°ê³µí•™   | 3    | 3    | ì´êµìˆ˜ | í™”2,3  | ì˜¤í”ˆì†ŒìŠ¤,OSP
5120003    | ìš´ì˜ì²´ì œ         | Operating System       | ì»´í“¨í„°ê³µí•™   | 3    | 3    | ë°•êµìˆ˜ | ëª©5,6  | OS,ìš´ì²´
0914002    | ê¸°ì´ˆì»´í“¨í„°í”„ë¡œê·¸ë˜ë° | Basic Programming   | ì»´í“¨í„°ê³µí•™   | 1    | 3    | ìµœêµìˆ˜ | ê¸ˆ1,2  | ê¸°í”„,ê¸°ì´ˆí”„ë¡œê·¸ë˜ë°
```

#### ê°œì„¤ê°•ì¢Œ Excel íŒŒì¼ í™œìš© ì „ëµ
1. **ì§ì ‘ í™œìš©**: ì‹¤ì œ ê°œì„¤ê°•ì¢Œ ë°ì´í„°ë¥¼ ê·¸ëŒ€ë¡œ ê³¼ëª© DBë¡œ ì‚¬ìš©
2. **ìë™ ë³„ëª… ìƒì„±**: ê³¼ëª©ëª… íŒ¨í„´ ë¶„ì„ìœ¼ë¡œ ì•½ì¹­ ìë™ ìƒì„±
3. **êµìˆ˜ëª… ë§¤ì¹­**: ì„±ì í‘œì˜ êµìˆ˜ëª…ê³¼ êµì°¨ ê²€ì¦ìœ¼ë¡œ ì •í™•ë„ í–¥ìƒ
4. **ì‹œê°„í‘œ ì •ë³´**: ì¶”ê°€ ê²€ì¦ ë°ì´í„°ë¡œ í™œìš©

### 2. ê°œì„¤ê°•ì¢Œ íŒŒì¼ ì²˜ë¦¬ ë°©ë²•

#### ê°œì„¤ê°•ì¢Œ ë°ì´í„° ë¡œë“œ ë° ì „ì²˜ë¦¬
```python
def load_semester_courses(file_path="ê°œì„¤ê°•ì¢Œ ëª©ë¡-2025-01í•™ê¸°-ì†Œí”„íŠ¸ì›¨ì–´í•™ë¶€.xlsx"):
    """ì‹¤ì œ ê°œì„¤ê°•ì¢Œ Excel íŒŒì¼ ë¡œë“œ ë° ì „ì²˜ë¦¬"""
    import pandas as pd

    # Excel íŒŒì¼ ë¡œë“œ
    df = pd.read_excel(file_path)

    # ì»¬ëŸ¼ëª… í‘œì¤€í™” (ì‹¤ì œ ì»¬ëŸ¼ëª…ì— ë§ê²Œ ì¡°ì • í•„ìš”)
    column_mapping = {
        'êµê³¼ëª©ë²ˆí˜¸': 'ê³¼ëª©ì½”ë“œ',
        'êµê³¼ëª©ëª…': 'ê³¼ëª©ëª…',
        'ë‹´ë‹¹êµìˆ˜': 'êµìˆ˜ëª…',
        'í•™ì ': 'í•™ì ',
        'ìš”ì¼ë°ê°•ì˜ì‹œê°„': 'ì‹œê°„í‘œ',
        'ê°•ì˜ì‹¤': 'ê°•ì˜ì‹¤'
    }
    df = df.rename(columns=column_mapping)

    # ìë™ ë³„ëª… ìƒì„±
    df['ë³„ëª…/ì•½ì¹­'] = df['ê³¼ëª©ëª…'].apply(generate_subject_aliases)

    # ê³¼ëª© DBë¡œ ì €ì¥
    df.to_excel('data/subject_database_2025_1.xlsx', index=False)
    return df

def generate_subject_aliases(subject_name):
    """ê³¼ëª©ëª…ì—ì„œ ìë™ìœ¼ë¡œ ë³„ëª…/ì•½ì¹­ ìƒì„±"""
    aliases = []

    # ì¼ë°˜ì ì¸ ì•½ì¹­ íŒ¨í„´
    patterns = {
        'í”„ë¡œê·¸ë˜ë°': ['í”„ë¡œê·¸ë˜ë°', 'í”„ë°'],
        'ì»´í“¨í„°': ['ì»´í“¨í„°', 'ì»´'],
        'ë°ì´í„°ë² ì´ìŠ¤': ['ë°ì´í„°ë² ì´ìŠ¤', 'DB', 'ë°ë² '],
        'ìš´ì˜ì²´ì œ': ['ìš´ì˜ì²´ì œ', 'OS', 'ìš´ì²´'],
        'ë„¤íŠ¸ì›Œí¬': ['ë„¤íŠ¸ì›Œí¬', 'ë„¤íŠ¸', 'ë„·'],
        'ì•Œê³ ë¦¬ì¦˜': ['ì•Œê³ ë¦¬ì¦˜', 'ì•Œê³ '],
        'ì¸ê³µì§€ëŠ¥': ['ì¸ê³µì§€ëŠ¥', 'AI', 'ì¸ì§€'],
        'ì†Œí”„íŠ¸ì›¨ì–´': ['ì†Œí”„íŠ¸ì›¨ì–´', 'SW', 'ì†Œì›¨'],
        'ì‹œìŠ¤í…œ': ['ì‹œìŠ¤í…œ', 'ì‹œìŠ¤'],
    }

    for key, values in patterns.items():
        if key in subject_name:
            aliases.extend(values)

    # ì²« ê¸€ì ì•½ì–´ ìƒì„± (ì˜ˆ: ì»´í“¨í„°êµ¬ì¡° â†’ ì»´êµ¬)
    words = subject_name.split()
    if len(words) >= 2:
        abbreviation = ''.join([word[0] for word in words if len(word) > 1])
        if len(abbreviation) >= 2:
            aliases.append(abbreviation)

    return ','.join(set(aliases))
```

### 3. ê°œì„¤ê°•ì¢Œ ê¸°ë°˜ í–¥ìƒëœ ë§¤ì¹­ ì‹œìŠ¤í…œ

```python
class EnhancedSubjectMatcher:
    def __init__(self, semester_file="ê°œì„¤ê°•ì¢Œ ëª©ë¡-2025-01í•™ê¸°-ì†Œí”„íŠ¸ì›¨ì–´í•™ë¶€.xlsx"):
        """ê°œì„¤ê°•ì¢Œ íŒŒì¼ ê¸°ë°˜ ë§¤ì¹­ ì‹œìŠ¤í…œ"""
        self.df = self.load_and_process_courses(semester_file)
        self.subject_dict = self._build_subject_dict()
        self.professor_dict = self._build_professor_dict()

    def load_and_process_courses(self, file_path):
        """ê°œì„¤ê°•ì¢Œ íŒŒì¼ ë¡œë“œ ë° ì²˜ë¦¬"""
        df = pd.read_excel(file_path)
        # ë³„ëª… ìë™ ìƒì„±
        df['ë³„ëª…/ì•½ì¹­'] = df['ê³¼ëª©ëª…'].apply(generate_subject_aliases)
        return df

    def _build_professor_dict(self):
        """êµìˆ˜ëª…-ê³¼ëª© ë§¤í•‘ ì‚¬ì „ êµ¬ì¶•"""
        prof_dict = {}
        for _, row in self.df.iterrows():
            if pd.notna(row.get('êµìˆ˜ëª…')):
                prof_name = str(row['êµìˆ˜ëª…']).strip()
                if prof_name not in prof_dict:
                    prof_dict[prof_name] = []
                prof_dict[prof_name].append(row['ê³¼ëª©ëª…'])
        return prof_dict

    def find_best_match_with_context(self, ocr_text, professor_name=None, threshold=70):
        """ì»¨í…ìŠ¤íŠ¸(êµìˆ˜ëª…)ë¥¼ í™œìš©í•œ í–¥ìƒëœ ë§¤ì¹­"""

        # 1. êµìˆ˜ëª…ì´ ìˆëŠ” ê²½ìš° í•´ë‹¹ êµìˆ˜ì˜ ê³¼ëª© ìš°ì„  ë§¤ì¹­
        if professor_name and professor_name in self.professor_dict:
            professor_subjects = self.professor_dict[professor_name]
            from fuzzywuzzy import process
            best_match = process.extractOne(ocr_text, professor_subjects, scorer=fuzz.ratio)
            if best_match and best_match[1] >= threshold - 10:  # êµìˆ˜ëª… ì¼ì¹˜ì‹œ ì„ê³„ê°’ ì™„í™”
                return best_match[0], best_match[1] + 5  # ì‹ ë¢°ë„ ë³´ë„ˆìŠ¤

        # 2. ì¼ë°˜ ë§¤ì¹­ìœ¼ë¡œ í´ë°±
        return self.find_best_match(ocr_text, threshold)

    def validate_with_multiple_fields(self, ocr_results):
        """ì—¬ëŸ¬ í•„ë“œë¥¼ êµì°¨ ê²€ì¦í•˜ì—¬ ì •í™•ë„ í–¥ìƒ"""
        validated_results = []

        for row in ocr_results:
            # ê³¼ëª©ì½”ë“œ, ê³¼ëª©ëª…, êµìˆ˜ëª…, í•™ì  ë“± ì—¬ëŸ¬ í•„ë“œ ë™ì‹œ ê²€ì¦
            subject_code = row.get('ê³¼ëª©ì½”ë“œ', '')
            subject_name = row.get('ê³¼ëª©ëª…', '')
            professor = row.get('êµìˆ˜ëª…', '')
            credits = row.get('í•™ì ', '')

            # ë°ì´í„°ë² ì´ìŠ¤ì™€ êµì°¨ ê²€ì¦
            db_match = self.df[
                (self.df['ê³¼ëª©ì½”ë“œ'] == subject_code) |
                (self.df['ê³¼ëª©ëª…'].str.contains(subject_name, na=False))
            ]

            if not db_match.empty:
                # DBì—ì„œ ì°¾ì€ ì •í™•í•œ ì •ë³´ë¡œ êµì²´
                validated_row = {
                    'ê³¼ëª©ì½”ë“œ': db_match.iloc[0]['ê³¼ëª©ì½”ë“œ'],
                    'ê³¼ëª©ëª…': db_match.iloc[0]['ê³¼ëª©ëª…'],
                    'êµìˆ˜ëª…': db_match.iloc[0].get('êµìˆ˜ëª…', professor),
                    'í•™ì ': db_match.iloc[0].get('í•™ì ', credits),
                    'ì‹ ë¢°ë„': 0.95
                }
            else:
                validated_row = row
                validated_row['ì‹ ë¢°ë„'] = 0.6

            validated_results.append(validated_row)

        return validated_results
```

### 4. ì ì§„ì  í•™ìŠµ ì‹œìŠ¤í…œ

```python
class OCRLearningSystem:
    def __init__(self):
        self.corrections_path = "data/training_data/ocr_corrections.xlsx"
        self.load_corrections()

    def add_correction(self, ocr_text, correct_text, confidence):
        """ìƒˆë¡œìš´ ì˜¤ë¥˜-ì •ë‹µ ë§¤í•‘ ì¶”ê°€ ë° í•™ìŠµ"""
        # ë¹ˆë„ ê¸°ë°˜ ìë™ í•™ìŠµ
        if self.get_frequency(ocr_text, correct_text) >= 3:
            self.update_database(ocr_text, correct_text)
```

---

## ğŸ”§ ê¸°ìˆ ì  ê°œì„  ë°©ë²•

### 1. ì´ë¯¸ì§€ ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸

#### ì›¹ ìŠ¤í¬ë¦°ìƒ· ì „ìš© ì „ì²˜ë¦¬
```python
def preprocess_web_screenshot(img):
    """ì„±ì ì¡°íšŒ í™”ë©´ ì „ìš© ì „ì²˜ë¦¬"""
    # 1. ìƒ‰ìƒ ë°˜ì „ (ë‹¤í¬ëª¨ë“œ â†’ ë¼ì´íŠ¸ëª¨ë“œ)
    img = cv2.bitwise_not(img)

    # 2. ê³ í•´ìƒë„ í™•ëŒ€ (2000px ì´ìƒ)
    height, width = img.shape[:2]
    if width < 2000:
        scale = 2000 / width
        new_size = (int(width * scale), int(height * scale))
        img = cv2.resize(img, new_size, interpolation=cv2.INTER_LANCZOS4)

    # 3. CLAHE ëŒ€ë¹„ í–¥ìƒ
    clahe = cv2.createCLAHE(clipLimit=3.0, tileGridSize=(8,8))
    if len(img.shape) == 2:
        img = clahe.apply(img)

    # 4. ìƒ¤í”„ë‹
    kernel = np.array([[-1,-1,-1],
                       [-1, 9,-1],
                       [-1,-1,-1]])
    img = cv2.filter2D(img, -1, kernel)

    return img
```

### 2. í…Œì´ë¸” ì˜ì—­ ê²€ì¶œ

```python
def detect_table_region(img):
    """í…Œì´ë¸” ì˜ì—­ ìë™ ê²€ì¶œ"""
    # ì—£ì§€ ê²€ì¶œ
    edges = cv2.Canny(img, 50, 150)

    # ì»¨íˆ¬ì–´ ì°¾ê¸°
    contours, _ = cv2.findContours(edges,
                                   cv2.RETR_EXTERNAL,
                                   cv2.CHAIN_APPROX_SIMPLE)

    # ìµœëŒ€ ì‚¬ê°í˜• ì˜ì—­ ì°¾ê¸°
    max_area = 0
    table_region = None

    for contour in contours:
        area = cv2.contourArea(contour)
        if area > max_area:
            x, y, w, h = cv2.boundingRect(contour)
            if w > img.shape[1] * 0.5 and h > img.shape[0] * 0.3:
                max_area = area
                table_region = (x, y, w, h)

    return table_region
```

### 3. PaddleOCR ìµœì í™” ì„¤ì •

```python
def create_optimized_ocr():
    """ìµœì í™”ëœ OCR ì¸ìŠ¤í„´ìŠ¤ ìƒì„±"""
    return PaddleOCR(
        lang='korean',
        use_angle_cls=False,        # ì›¹ ìŠ¤í¬ë¦°ìƒ·ì€ í•­ìƒ ìˆ˜í‰
        use_gpu=True,               # GPU ê°€ì†

        # ê²€ì¶œ íŒŒë¼ë¯¸í„°
        det_db_thresh=0.2,          # ë‚®ì€ ì„ê³„ê°’ìœ¼ë¡œ ì‘ì€ í…ìŠ¤íŠ¸ë„ ê²€ì¶œ
        det_db_box_thresh=0.3,
        det_limit_side_len=1960,    # í° ì´ë¯¸ì§€ í—ˆìš©

        # ì¸ì‹ íŒŒë¼ë¯¸í„°
        rec_batch_num=50,           # í° ë°°ì¹˜ í¬ê¸°
        max_text_length=50,         # ê¸´ í…ìŠ¤íŠ¸ í—ˆìš©
        drop_score=0.2,             # ë‚®ì€ ìŠ¤ì½”ì–´ë„ í¬í•¨
        use_space_char=True,

        # ëª¨ë¸ ì„ íƒ
        rec_algorithm='SVTR_LCNet'  # PP-OCRv4
    )
```

### 4. í…Œì´ë¸” êµ¬ì¡° ë³µì›

```python
def extract_table_structure(ocr_results):
    """OCR ê²°ê³¼ë¥¼ í…Œì´ë¸” êµ¬ì¡°ë¡œ ë³€í™˜"""
    # Y ì¢Œí‘œë¡œ í–‰ ê·¸ë£¹í•‘
    rows = []
    current_row = []
    last_y = -1

    for result in sorted(ocr_results, key=lambda x: x[0][0][1]):
        y = result[0][0][1]
        if last_y != -1 and abs(y - last_y) > 30:
            rows.append(sorted(current_row, key=lambda x: x[0][0][0]))
            current_row = []
        current_row.append(result)
        last_y = y

    if current_row:
        rows.append(sorted(current_row, key=lambda x: x[0][0][0]))

    # í—¤ë”ì™€ ë°ì´í„° ë¶„ë¦¬
    headers = [cell[1][0] for cell in rows[0]] if rows else []
    data_rows = []

    for row in rows[1:]:
        row_data = {}
        for i, cell in enumerate(row):
            if i < len(headers):
                row_data[headers[i]] = cell[1][0]
        data_rows.append(row_data)

    return {"headers": headers, "data": data_rows}
```

### 5. ì¶œë ¥ í¬ë§·í„°

```python
class OutputFormatter:
    @staticmethod
    def to_json(table_data, metadata=None):
        """JSON í˜•ì‹ìœ¼ë¡œ ë³€í™˜"""
        output = {
            "timestamp": datetime.now().isoformat(),
            "table": table_data,
            "metadata": metadata or {}
        }
        return json.dumps(output, ensure_ascii=False, indent=2)

    @staticmethod
    def to_csv(table_data):
        """CSV í˜•ì‹ìœ¼ë¡œ ë³€í™˜"""
        df = pd.DataFrame(table_data["data"])
        return df.to_csv(index=False, encoding='utf-8-sig')
```

---

## ğŸ“Š êµ¬í˜„ ë¡œë“œë§µ

### Phase 1: ê¸°ì´ˆ êµ¬ì¶• (Day 1-2)
- [x] í”„ë¡œì íŠ¸ êµ¬ì¡° ì„¤ì •
- [x] ê°œì„¤ê°•ì¢Œ Excel íŒŒì¼ í™•ë³´ (2025-01í•™ê¸° ì†Œí”„íŠ¸ì›¨ì–´í•™ë¶€)
- [ ] ê°œì„¤ê°•ì¢Œ ë°ì´í„°ë¥¼ ê³¼ëª© DBë¡œ ë³€í™˜
- [ ] ìë™ ë³„ëª…/ì•½ì¹­ ìƒì„± ì‹œìŠ¤í…œ êµ¬í˜„

### Phase 2: í•µì‹¬ ëª¨ë“ˆ ê°œë°œ (Day 3-5)
- [ ] `core/subject_matcher.py` - ê³¼ëª© ë§¤ì¹­ ì‹œìŠ¤í…œ
- [ ] `core/table_extractor.py` - í…Œì´ë¸” ê²€ì¶œ
- [ ] `core/preprocessor.py` - ì´ë¯¸ì§€ ì „ì²˜ë¦¬
- [ ] `core/postprocessor.py` - í…ìŠ¤íŠ¸ í›„ì²˜ë¦¬

### Phase 3: í•™ìŠµ ì‹œìŠ¤í…œ (Day 6-7)
- [ ] í…œí”Œë¦¿ ì´ë¯¸ì§€ ìˆ˜ì§‘ ë° í•™ìŠµ
- [ ] ì‚¬ìš©ì í”¼ë“œë°± ì‹œìŠ¤í…œ
- [ ] ìë™ ê°œì„  íŒŒì´í”„ë¼ì¸

### Phase 4: í†µí•© ë° ìµœì í™” (Day 8)
- [ ] `improved_main.py` ì‘ì„±
- [ ] API ì„œë²„ êµ¬ì¶•
- [ ] ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ë° ë²¤ì¹˜ë§ˆí¬

---

## ğŸ¯ ì„±ëŠ¥ ëª©í‘œ

### ì •í™•ë„ ê°œì„  (ê°œì„¤ê°•ì¢Œ DB í™œìš©)
| í•­ëª© | í˜„ì¬ | ëª©í‘œ | ê°œì„  ë°©ë²• |
|------|------|------|----------|
| ê³¼ëª©ëª… ì¸ì‹ | 60% | **95%+** | ê°œì„¤ê°•ì¢Œ DB ì§ì ‘ ë§¤ì¹­ |
| ê³¼ëª©ì½”ë“œ ì¸ì‹ | 70% | **98%+** | 7ìë¦¬ íŒ¨í„´ + DB ê²€ì¦ |
| êµìˆ˜ëª… ì¸ì‹ | 50% | **90%+** | ê°œì„¤ê°•ì¢Œ êµìˆ˜ëª… êµì°¨ ê²€ì¦ |
| í…Œì´ë¸” êµ¬ì¡° | 75% | **95%+** | í…œí”Œë¦¿ ë§¤ì¹­ + êµ¬ì¡° ë¶„ì„ |
| ì „ì²´ ì •í™•ë„ | 68% | **95%+** | ë‹¤ì¤‘ í•„ë“œ êµì°¨ ê²€ì¦ |

### ì²˜ë¦¬ ì†ë„
- í˜„ì¬: ì´ë¯¸ì§€ë‹¹ 3-5ì´ˆ
- ëª©í‘œ: ì´ë¯¸ì§€ë‹¹ 1-2ì´ˆ (í…Œì´ë¸” ì˜ì—­ë§Œ ì²˜ë¦¬)

### ì¶œë ¥ í’ˆì§ˆ
- êµ¬ì¡°í™”ëœ JSON/CSV ì¶œë ¥
- ë©”íƒ€ë°ì´í„° í¬í•¨ (ì‹ ë¢°ë„, ì²˜ë¦¬ì‹œê°„)
- ì¦‰ì‹œ í™œìš© ê°€ëŠ¥í•œ ë°ì´í„° í˜•ì‹

---

## ğŸš€ ë¹ ë¥¸ ì‹œì‘ ê°€ì´ë“œ

### 1. í™˜ê²½ ì„¤ì •
```bash
# ê°€ìƒí™˜ê²½ ìƒì„± ë° í™œì„±í™”
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# ì˜ì¡´ì„± ì„¤ì¹˜
pip install -r requirements.txt
```

### 2. ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¶•
```bash
# ê°œì„¤ê°•ì¢Œ íŒŒì¼ì„ data í´ë”ë¡œ ë³µì‚¬
mkdir -p data/semester_courses
cp "ê°œì„¤ê°•ì¢Œ ëª©ë¡-2025-01í•™ê¸°-ì†Œí”„íŠ¸ì›¨ì–´í•™ë¶€.xlsx" data/semester_courses/

# ê³¼ëª© DB ìë™ ìƒì„±
python -c "
from core.subject_matcher import EnhancedSubjectMatcher
matcher = EnhancedSubjectMatcher('data/semester_courses/ê°œì„¤ê°•ì¢Œ ëª©ë¡-2025-01í•™ê¸°-ì†Œí”„íŠ¸ì›¨ì–´í•™ë¶€.xlsx')
print(f'ê³¼ëª© DB ìƒì„± ì™„ë£Œ: {len(matcher.df)}ê°œ ê³¼ëª©')
"
```

### 3. OCR ì‹¤í–‰
```python
from improved_main import ImprovedOCR

# ê°œì„¤ê°•ì¢Œ íŒŒì¼ ê¸°ë°˜ OCR ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
ocr = ImprovedOCR(
    semester_file="data/semester_courses/ê°œì„¤ê°•ì¢Œ ëª©ë¡-2025-01í•™ê¸°-ì†Œí”„íŠ¸ì›¨ì–´í•™ë¶€.xlsx",
    output_format="json"
)

# ì´ë¯¸ì§€ ì²˜ë¦¬ (ì„±ì ì¡°íšŒ ìŠ¤í¬ë¦°ìƒ·)
result = ocr.process_image("assets/images/main_test_1.png")

# ê°œì„¤ê°•ì¢Œ ì •ë³´ì™€ êµì°¨ ê²€ì¦
validated_result = ocr.validate_with_semester_data(result)

# ê²°ê³¼ ì €ì¥ (JSON/CSV)
ocr.save_results(validated_result, "output/grades_2025_1.json")
ocr.save_as_csv(validated_result, "output/grades_2025_1.csv")
```

---

## ğŸ“ ìœ ì§€ë³´ìˆ˜ ê°€ì´ë“œ

### ë°ì´í„°ë² ì´ìŠ¤ ì—…ë°ì´íŠ¸
1. **ìƒˆ í•™ê¸° ê°œì„¤ê°•ì¢Œ ì¶”ê°€**:
   - ë§¤ í•™ê¸° ê°œì„¤ê°•ì¢Œ Excel íŒŒì¼ ë‹¤ìš´ë¡œë“œ
   - `data/semester_courses/` í´ë”ì— ì €ì¥
   - íŒŒì¼ëª… í˜•ì‹: `ê°œì„¤ê°•ì¢Œ ëª©ë¡-YYYY-Ní•™ê¸°-í•™ë¶€ëª….xlsx`

2. **ìë™ DB ì—…ë°ì´íŠ¸ ìŠ¤í¬ë¦½íŠ¸**:
```python
# scripts/update_semester_db.py
import os
from glob import glob

def update_all_semester_databases():
    """ëª¨ë“  ê°œì„¤ê°•ì¢Œ íŒŒì¼ì„ í†µí•© DBë¡œ ë³€í™˜"""
    files = glob("data/semester_courses/*.xlsx")
    for file in files:
        print(f"Processing: {file}")
        # ê° íŒŒì¼ ì²˜ë¦¬ ë° í†µí•©
```

3. **OCR ì˜¤ë¥˜ ìë™ í•™ìŠµ**:
   - ì‚¬ìš©ì ìˆ˜ì • ë‚´ì—­ ìë™ ìˆ˜ì§‘
   - ë¹ˆë„ 3íšŒ ì´ìƒì‹œ DB ìë™ ì—…ë°ì´íŠ¸

### ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
```python
# ì¼ì¼ ì„±ëŠ¥ ì²´í¬
python scripts/daily_performance_check.py

# ë²¤ì¹˜ë§ˆí¬ ì‹¤í–‰
python scripts/benchmark.py --test-images ./test_data/
```

### íŠ¸ëŸ¬ë¸”ìŠˆíŒ…
- **ë‚®ì€ ì •í™•ë„**: ì´ë¯¸ì§€ ì „ì²˜ë¦¬ íŒŒë¼ë¯¸í„° ì¡°ì •
- **ëŠë¦° ì²˜ë¦¬**: GPU ì‚¬ìš© í™•ì¸, ë°°ì¹˜ í¬ê¸° ì¡°ì •
- **ë©”ëª¨ë¦¬ ë¶€ì¡±**: ì´ë¯¸ì§€ í¬ê¸° ì œí•œ, ìºì‹œ ì •ë¦¬

---

## ğŸ”— ì°¸ê³  ìë£Œ
- [PaddleOCR ê³µì‹ ë¬¸ì„œ](https://github.com/PaddlePaddle/PaddleOCR)
- [OpenCV ì´ë¯¸ì§€ ì „ì²˜ë¦¬](https://docs.opencv.org/4.x/)
- [FastAPI ë¬¸ì„œ](https://fastapi.tiangolo.com/)

---

*ì´ ë¬¸ì„œëŠ” OCR_ACCURACY_TROUBLESHOOTING.md, PROJECT_STRUCTURE_GUIDE.md, SUBJECT_DATABASE_GUIDE.mdë¥¼ í†µí•©í•˜ì—¬ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.*